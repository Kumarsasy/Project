new code added from sasi branch

code updated from kumar branch
